{% extends 'base.html.twig' %}

{% block title %} {{commercialSheet.type|capitalize}} ID # {{commercialSheet.number}} {% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="https://printjs-4de6.kxcdn.com/print.min.css"/>
{% endblock %}

{% block pageTitle %}
<h4 class="page-title mb-2"><i class="mdi mdi-file-table-outline mr-2"></i>Commercial Sheet</h4>  
{% endblock %}

{% block breadcrumb %}
    <div class="">
        <ol class="breadcrumb">
            <li class="breadcrumb-item active">Commercial Sheet</li>
            <li class="breadcrumb-item active">{{commercialSheet.type|capitalize}}</li>
        </ol>
    </div>
{% endblock %}

{% block body %}
<div class="row">
    <div class="col-lg-9 mx-auto">
        <div class="card">
            <div class="card-body invoice-head">
                <div class="row">
                    <div class="col-md-4 align-self-center">
                        <img src="/images/LBF.png" alt="LBF logo-small" class="logo-sm mr-2"
                            height="100">
                        {#<img src="/images/LBF.png" alt="LBF logo-large" class="logo-lg"
                            height="18">#}
                    </div>
                    <div class="col-md-8">

                        <ul class="list-inline mb-0 contact-detail float-right">
                            <li class="list-inline-item">
                                <div class="pl-3">
                                    <i class="mdi mdi-web"></i>
                                    <p class="text-muted mb-0">www.leeloubabyfood.com</p>
                                    {#<p class="text-muted mb-0">www.qrstuvwxyz.com</p>#}
                                </div>
                            </li>
                            <li class="list-inline-item">
                                <div class="pl-3">
                                    <i class="mdi mdi-phone"></i>
                                    <p class="text-muted mb-0">{{commercialSheet.user.enterprise.phoneNumber}}</p>
                                </div>
                            </li>
                            <li class="list-inline-item">
                                <div class="pl-3">
                                    <i class="mdi mdi-map-marker"></i>
                                    <p class="text-muted mb-0">{{commercialSheet.user.enterprise.address}}</p>
                                    {#<p class="text-muted mb-0">Cameroun.</p>#}
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!--end card-body-->
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="">
                            <h6 class="mb-0"><b>{{commercialSheet.type|capitalize}} Date :</b> {{commercialSheet.createdAt|date("d/m/Y")}}</h6>
                            <h6><b>{{commercialSheet.type|capitalize}} ID :</b> # {{commercialSheet.number}}</h6>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="float-left">
                            <address class="font-13">
                                <strong class="font-14">{% if commercialSheet.type == 'bill' %}Billed{% elseif commercialSheet.type == 'quote' %}Quoted{% endif %} To :</strong><br>
                                {{commercialSheet.businessContact.socialReason}}<br>
                                {{commercialSheet.businessContact.address}}<br>
                                <abbr title="Phone">P:</abbr> {{commercialSheet.businessContact.phoneNumber}}
                            </address>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="">
                            <address class="font-13">
                                <strong class="font-14">Shipped To:</strong><br>
                                {{commercialSheet.businessContact.socialReason}}<br>
                                {{commercialSheet.businessContact.address}}<br>
                                <abbr title="Phone">P:</abbr> {{commercialSheet.businessContact.phoneNumber}}
                            </address>
                        </div>
                    </div>

                    {#<div class="col-md-3">
                        <div class="text-center bg-light p-3 mb-3">
                            <h5 class="bg-primary mt-0 p-2 text-white d-sm-inline-block">Payment Methods
                            </h5>
                            <h6 class="font-13">Paypal & Cards Payments :</h6>
                            <p class="mb-0 text-muted">Companyaccountpaypal@gmai.com</p>
                            <p class="mb-0 text-muted">Visa, Master Card, Chaque</p>
                        </div>
                    </div>#}
                </div>

                <div class="row">
                    <div class="col-lg-12">
                        <div class="table-responsive">
                            <table class="table table-bordered mb-0">
                                <thead>
                                    <tr>
                                        <th colspan="5" class="text-center font-14">{{commercialSheet.type|capitalize}} Item Details
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>SKU</th>
                                        <th>Designation</th>
                                        <th class="text-center">P.U (XAF)</th>
                                        <th class="text-center">Quantity</th>
                                        <th class="text-center">Total (XAF)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% set itemsAmount = 0 %}
                                    {% set price = 0 %}
                                    {% set promoAmount = 0 %}
                                    {% set total = 0 %}
                                    {% for commercialSheetItem in commercialSheet.commercialSheetItems %}
                                    <tr>
                                        <th>{{commercialSheetItem.reference}}</th>
                                        <td>{{commercialSheetItem.designation}}</td>
                                        <td class="text-center">{{commercialSheetItem.pu}}</td>
                                        <td class="text-center">{{commercialSheetItem.quantity}}</td>
                                        <td class="text-center">{{commercialSheetItem.quantity * commercialSheetItem.pu}}</td>
                                        {% set itemsAmount = itemsAmount + (commercialSheetItem.quantity * commercialSheetItem.pu) %}
                                    </tr>
                                    {% endfor %}
                                    {#<tr>
                                        <th>1</th>
                                        <td>Mobile</td>
                                        <td>It is a long established fact that a reader will be
                                            distracted.</td>
                                        <td>$100.00</td>
                                        <td>$100.00</td>
                                    </tr>
                                    <tr>
                                        <th>3</th>
                                        <td>Chair</td>
                                        <td>Contrary to popular belief, Lorem Ipsum is not simply random
                                            text.</td>
                                        <td>$30.00</td>
                                        <td>$90.00</td>
                                    </tr>
                                    <tr>
                                        <th>1</th>
                                        <td>Camera</td>
                                        <td>Aldus PageMaker including versions of Lorem Ipsum.</td>
                                        <td>$999.00</td>
                                        <td>$999.00</td>
                                    </tr>
                                    <tr>
                                        <th>3</th>
                                        <td>Headphone</td>
                                        <td>Various versions have evolved over the years, sometimes by
                                            accident.</td>
                                        <td>$20.00</td>
                                        <td>$60.00</td>
                                    </tr>#}
                                    <tr>
                                        <td colspan="2" class="border-0"></td>
                                        <td colspan="3" class="border-0 font-14 text-center"><b>Items Amount SubTotal : {{itemsAmount}} FCFA</b></td>
                                        {#<td colspan="2" class="border-0 font-14 text-center"><b>{{itemsAmount}} FCFA</b></td>#}
                                    </tr>
                                    <tr>
                                        <td colspan="2" class="border-0"></td>
                                        <td colspan="3" class="border-0 font-14 text-center"><b>Delivery Fees : {{commercialSheet.deliveryFees}} FCFA</b></td>
                                        {#<td class="border-0 font-14 text-center"><b>{{order.customer.deliveryAddress.fees}} FCFA</b></td>#}
                                    </tr>
                                    <tr>
                                        <th colspan="5" class="text-center font-14">Promotion Details
                                        </th>
                                    </tr>
                                    {# <tr>
                                        <td colspan="3" class="border-0">
                                            Nber of 240mL returned : 
                                            {% for reduction in order.reductions %}
                                                {% if reduction.returnedJars.potVolume == 240 %}
                                                    {% set qty240 = qty240 + reduction.quantity %}
                                                    {% set price = reduction.returnedJars.price %}
                                                {% endif %}
                                            {% endfor %}
                                            {% set promoAmount = promoAmount + (price * qty240) %}
                                            {{qty240}}
                                        </td>
                                        <td colspan="2" class="border-0"></td>
                                    </tr>
                                    <tr>
                                        <td colspan="3" class="border-0">Nber of 100mL returned : 
                                        {% for reduction in order.reductions %}
                                            {% if reduction.returnedJars.potVolume == 100 %}
                                                {% set qty100 = qty100 + reduction.quantity %}
                                                {% set price = reduction.returnedJars.price %}
                                            {% endif %}
                                        {% endfor %}
                                        {% set promoAmount = promoAmount + (price * qty100) %}
                                        {{qty100}}
                                        </td>
                                        <td colspan="2" class="border-0"></td>
                                    </tr> #}
                                    <tr>
                                        <td colspan="3" class="border-0">% reductionof items total : {{commercialSheet.itemsReduction}}
                                        </td>
                                        <td colspan="2" class="border-0"></td>
                                    </tr>
                                    <tr>
                                        <td colspan="3" class="border-0">Fix reduction : {{commercialSheet.fixReduction}}
                                        </td>
                                        <td colspan="2" class="border-0"></td>
                                    </tr>
                                    <tr>
                                        {% set promoAmount = promoAmount + commercialSheet.itemsReduction + commercialSheet.fixReduction %}
                                        <th colspan="2" class="border-0"></th>
                                        <td colspan="3" class="border-0 font-14 text-right pr-4"><b>Promotion amount Subtotal : {{promoAmount}} FCFA</b></td>
                                        {#<td class="border-0 font-14"><b>{{promoAmount}} FCFA</b></td>#}
                                    </tr>
                                    <tr>
                                        {% set taxes = (app.user.enterprise.tva / 100.0) * itemsAmount %}
                                        <th colspan="2" class="border-0"></th>
                                        <td colspan="3" class="border-0 font-14 text-right pr-4"><b>Taxes : {{taxes}} FCFA</b></td>
                                        {#<td class="border-0 font-14"><b>{{promoAmount}} FCFA</b></td>#}
                                    </tr>
                                    <tr>
                                        <th colspan="2" class="border-0"></th>
                                        <td colspan="3" class="border-0 font-14 text-right pr-4"><b>Advance Payment : {{commercialSheet.advancePayment}} FCFA</b></td>
                                        {#<td class="border-0 font-14"><b>{{promoAmount}} FCFA</b></td>#}
                                    </tr>
                                                    
                                    <tr class="bg-dark text-white">
                                        {% set total = itemsAmount + commercialSheet.deliveryFees + taxes - promoAmount - commercialSheet.advancePayment %}
                                        <th colspan="3" class="border-0"></th>
                                        <td class="border-0 font-14"><b>Total Net To Paid</b></td>
                                        <td class="border-0 font-14"><b>{{total}} FCFA</b></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-6">
                        {#<h5 class="mt-4">Terms And Condition :</h5>
                        <ul class="pl-3">
                            <li><small>All accounts are to be paid within 7 days from receipt of
                                    invoice. </small></li>
                            <li><small>To be paid by cheque or credit card or direct payment
                                    online.</small></li>
                            <li><small> If account is not paid within 7 days the credits details
                                    supplied as confirmation<br> of work undertaken will be charged the
                                    agreed quoted fee noted above.</small></li>
                        </ul>#}
                    </div>
                    <div class="col-lg-6 align-self-end">
                        <div class="w-25 float-right">
                            {#<small>Account Manager</small>
                            <img src="/images/signature.png" alt="" class="" height="48">#}
                            <br>
                            <br>
                            <br>
                            <br>
                            
                            <p class="border-top text-center">Signature</p>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row d-flex justify-content-center">
                    <div class="col-lg-12 col-xl-4 ml-auto align-self-center">
                        <div class="text-center text-muted"><small>Thank you very much for doing
                                business with us. Thanks !</small></div>
                    </div>
                    <div class="col-lg-12 col-xl-4">
                        <div class="float-right d-print-none">
                            {#<button type="button" onclick="printJS('printJS-form', 'html')" class="btn btn-info text-light">
                                <i class="fa fa-print"></i>
                            </button>#}
                            <a href="javascript:window.print()"  class="btn btn-info text-light"><i class="fa fa-print"></i></a>
                            {#<a href="#" class="btn btn-primary text-light">Submit</a>
                            printJS('docs/printjs.pdf')
                            javascript:window.print()
                            #}
                            <a href="{{path('commercial_sheet_index',{'type':commercialSheet.type})}}" class="btn btn-danger text-light"><i
                                    class="fa fa-arrow-circle-left mr-2"></i>Back</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--end card-->
    </div>
    <!--end col-->
</div>
<!--end row-->
{% endblock %}

{% block javascripts %}
{# <script src="https://printjs-4de6.kxcdn.com/print.min.js" ></script> #}
{% endblock %}